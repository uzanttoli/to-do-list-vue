<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="/styles/global.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    />
    <title>Lista de Tarefas</title>
  </head>
  <body>
    <div id="app" class="app">
      <div class="list">
        <div class="create-task">
          <p>Criar Tarefas</p>
          <input
            type="text"
            placeholder="Digite uma tarefa!"
            v-model="insertTask"
          />
          <button v-on:click="createTasks()">Criar</button>
        </div>
        <ul v-for="(item, i) in listTasks" :key="i">
          <li :class="item.checked == true ? 'task-completed' : ''">
            <label class="container">
              <input
                type="checkbox"
                :name="item.task"
                :id="item.id"
                v-on:change="actionTask"
                v-bind:checked="item.checked"
              />
              <div class="checkmark"></div>
              <div class="container-span">
                <span
                  :class="item.checked == true ? 'task-completed' : ''"
                  class="break-text"
                >
                  {{item.task}}
                </span>
              </div>
            </label>
            <div class="other-action">
              <button v-on:click="otherTask('remove', item.id)" v-bind:disabled="item.checked">
                <i class="fas fa-trash-alt"></i>
              </button>
              <!-- <button v-on:click="otherTask('update', item.id)"><i class="fas fa-edit"></i></button> -->
            </div>
          </li>
        </ul>
      </div>
    </div>
  </body>
  <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>

  <script>
    var app = new Vue({
      el: "#app",
      data: {
        insertTask: null,
        listTasks: [],
      },
      methods: {
        createTasks() {
          if (!this.insertTask) return;
          let idRandom = Number(new Date().toISOString().replace(/\D/g, ""));
          this.listTasks.unshift({
            id: idRandom,
            task: this.insertTask.toUpperCase(),
            checked: false,
          });
          this.insertTask = null;
        },
        actionTask(item) {
          let updatedTask = this.listTasks.find(
            (element) => element.id == item.target.id
          );
          if (updatedTask) {
            updatedTask.checked = item.target.checked;
          }
        },
        otherTask(action, id) {
          if (action == "update") {
            let editTaks = this.listTasks.find((item) => item.id === id);
            if (editTaks) {
              this.insertTask = editTaks.task;
              editTaks.task = this.insertTask;
            }
          } else {
            const indice = this.listTasks.findIndex(
              (object) => object.id == id
            );
            this.listTasks.splice(indice, 1);
          }
        },
      },
    });
  </script>
</html>
